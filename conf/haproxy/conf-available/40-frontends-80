# included file for haproxy configuration

frontend http
	bind  *:80
	http-request			set-header X-Forwarded-Protocol http
	default_backend	default

	acl S_DOMAIN_FQDN					hdr_end(host) -i S_DOMAIN_FQDN
	acl S_DOMAIN_FQDN					hdr_sub(host) -i S_DOMAIN_FQDN
	#acl S_DOMAIN_FQDN-check		path_dir /server-status /server-info /status-www /ping-www /ping-monitor
	acl S_DOMAIN_FQDN-check			path_reg ^/(server-status|server-info|status-www|ping-www|ping-monitor)
	#acl S_DOMAIN_FQDN-check		path_beg /server-status /server-info /status-www /ping-www /ping-monitor

	# _HPX_DOMAIN_2_FQDN
	#acl _HPX_DOMAIN_2_FQDN		hdr_end(host) -i _HPX_DOMAIN_2_FQDN

	#redirect				scheme https code 301 if S_DOMAIN_FQDN !S_DOMAIN_FQDN-check !{ ssl_fc }
	#redirect				scheme https code 301 if !S_DOMAIN_FQDN-check !{ ssl_fc }

	#use_backend	S_DOMAIN_FQDN-admin if admin
	use_backend		S_DOMAIN_FQDN if S_DOMAIN_FQDN || S_DOMAIN_FQDN-check
